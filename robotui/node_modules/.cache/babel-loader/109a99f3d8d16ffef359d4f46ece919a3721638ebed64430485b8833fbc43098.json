{"ast":null,"code":"import _toConsumableArray from\"/home/darkadius/ros2_ws/src/BotshareWIP/ROS2/robotui/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import React,{useContext,useRef,useEffect}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import moment from\"moment\";import{AppConfig}from\"../shared/constants/index\";import{RosContext}from\"../app/App\";import{logsSelector,setLogs,addSingleLog}from\"../stores\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var RobotLog=function RobotLog(){var ros=useContext(RosContext);var dispatch=useDispatch();var _useSelector=useSelector(logsSelector),logs=_useSelector.logs;var messageTopic=useRef(new window.ROSLIB.Topic({ros:ros,name:AppConfig.UI_MESSAGE_TOPIC,messageType:\"std_msgs/String\"}));useEffect(function(){console.log(\"Logs component update\");var currentMessageTopic=messageTopic.current;currentMessageTopic.subscribe(function(_ref){var data=_ref.data;console.log(\"DATA LOGS\",data);console.log(\"OLD LOGS\",logs);var currentTime=moment().format(\"HH:mm:ss\");var message=\"\".concat(currentTime,\": \").concat(data);// const newMsgList = [message, ...logs];\ndispatch(addSingleLog(message));});return function(){return currentMessageTopic.unsubscribe();};// eslint-disable-next-line react-hooks/exhaustive-deps\n},[dispatch]);var Messages=function Messages(){if(logs.length===0){return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"li\",{className:\"flex h-full items-center justify-center text-center font-[RobotoMono] text-themeTextGray\",children:\"Console is empty\"})});}var messageItems=logs.map(function(msgItem){return/*#__PURE__*/_jsx(\"li\",{children:msgItem},Math.random());});return messageItems;};var onClearClick=function onClearClick(){dispatch(setLogs([]));};// eslint-disable-next-line no-unused-vars\nvar onAddNewMessage=function onAddNewMessage(){var currentTime=moment().format(\"HH:mm:ss\");var message=\"\".concat(currentTime,\": \").concat(currentTime);var newMsgList=[message].concat(_toConsumableArray(logs));dispatch(setLogs(newMsgList));};return/*#__PURE__*/_jsxs(\"article\",{className:\"flex h-full w-full flex-col rounded-lg bg-white font-[RobotoMono]\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"flex items-center justify-between rounded-t-lg bg-themeBlue px-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg text-white xl:text-xl\",children:\"Messages\"}),/*#__PURE__*/_jsx(\"button\",{className:\"my-2 rounded-lg bg-white px-[10px] py-[7px] text-lg text-themeDarkBlue hover:bg-themeLightGray active:bg-themeDarkBlue active:text-white xl:text-xl\",onClick:onClearClick,children:\"Clear\"})]}),/*#__PURE__*/_jsx(\"ul\",{className:\"flex flex-1 flex-col-reverse overflow-y-auto rounded-b-lg border border-themeBlue px-4 py-3\",children:/*#__PURE__*/_jsx(Messages,{})})]});};export default RobotLog;","map":{"version":3,"names":["React","useContext","useRef","useEffect","useDispatch","useSelector","moment","AppConfig","RosContext","logsSelector","setLogs","addSingleLog","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","RobotLog","ros","dispatch","_useSelector","logs","messageTopic","window","ROSLIB","Topic","name","UI_MESSAGE_TOPIC","messageType","console","log","currentMessageTopic","current","subscribe","_ref","data","currentTime","format","message","concat","unsubscribe","Messages","length","children","className","messageItems","map","msgItem","Math","random","onClearClick","onAddNewMessage","newMsgList","_toConsumableArray","onClick"],"sources":["/home/darkadius/ros2_ws/src/BotshareWIP/ROS2/robotui/src/components/Logs.jsx"],"sourcesContent":["import React, { useContext, useRef, useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport moment from \"moment\";\n\nimport { AppConfig } from \"../shared/constants/index\";\nimport { RosContext } from \"../app/App\";\nimport { logsSelector, setLogs, addSingleLog } from \"../stores\";\n\nconst RobotLog = () => {\n  const ros = useContext(RosContext);\n  const dispatch = useDispatch();\n  const { logs } = useSelector(logsSelector);\n\n  const messageTopic = useRef(\n    new window.ROSLIB.Topic({\n      ros,\n      name: AppConfig.UI_MESSAGE_TOPIC,\n      messageType: \"std_msgs/String\",\n    }),\n  );\n  useEffect(() => {\n    console.log(\"Logs component update\");\n\n    const currentMessageTopic = messageTopic.current;\n    currentMessageTopic.subscribe(({ data }) => {\n      console.log(\"DATA LOGS\", data);\n      console.log(\"OLD LOGS\", logs);\n      const currentTime = moment().format(\"HH:mm:ss\");\n      const message = `${currentTime}: ${data}`;\n      // const newMsgList = [message, ...logs];\n      dispatch(addSingleLog(message));\n    });\n    return () => currentMessageTopic.unsubscribe();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [dispatch]);\n\n  const Messages = () => {\n    if (logs.length === 0) {\n      return (\n        <>\n          <li className=\"flex h-full items-center justify-center text-center font-[RobotoMono] text-themeTextGray\">\n            Console is empty\n          </li>\n        </>\n      );\n    }\n\n    const messageItems = logs.map((msgItem) => {\n      return <li key={Math.random()}>{msgItem}</li>;\n    });\n    return messageItems;\n  };\n\n  const onClearClick = () => {\n    dispatch(setLogs([]));\n  };\n\n  // eslint-disable-next-line no-unused-vars\n  const onAddNewMessage = () => {\n    const currentTime = moment().format(\"HH:mm:ss\");\n    const message = `${currentTime}: ${currentTime}`;\n    const newMsgList = [message, ...logs];\n\n    dispatch(setLogs(newMsgList));\n  };\n\n  return (\n    <article className=\"flex h-full w-full flex-col rounded-lg bg-white font-[RobotoMono]\">\n      <header className=\"flex items-center justify-between rounded-t-lg bg-themeBlue px-4\">\n        <h2 className=\"text-lg text-white xl:text-xl\">Messages</h2>\n        <button\n          className=\"my-2 rounded-lg bg-white px-[10px] py-[7px] text-lg text-themeDarkBlue hover:bg-themeLightGray active:bg-themeDarkBlue active:text-white xl:text-xl\"\n          onClick={onClearClick}\n        >\n          Clear\n        </button>\n        {/* <button\n          className=\"my-2 rounded-lg bg-white px-[10px] py-[7px] text-lg hover:bg-themeLightGray active:bg-themeTextGray active:text-white xl:text-xl\"\n          onClick={onAddNewMessage}\n        >\n          Add\n        </button> */}\n      </header>\n      <ul className=\"flex flex-1 flex-col-reverse overflow-y-auto rounded-b-lg border border-themeBlue px-4 py-3\">\n        <Messages />\n      </ul>\n    </article>\n  );\n};\n\nexport default RobotLog;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}