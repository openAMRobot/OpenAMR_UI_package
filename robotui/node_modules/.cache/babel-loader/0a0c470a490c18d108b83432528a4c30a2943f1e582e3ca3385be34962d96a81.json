{"ast":null,"code":"import { transformedNormalView } from '../../accessors/NormalNode.js';\nimport { positionViewDirection } from '../../accessors/PositionNode.js';\nimport { sheen, sheenRoughness } from '../../core/PropertyNode.js';\nimport { tslFn, float } from '../../shadernode/ShaderNode.js';\n\n// https://github.com/google/filament/blob/master/shaders/src/brdf.fs\nvar D_Charlie = function D_Charlie(roughness, dotNH) {\n  var alpha = roughness.pow2();\n\n  // Estevez and Kulla 2017, \"Production Friendly Microfacet Sheen BRDF\"\n  var invAlpha = float(1.0).div(alpha);\n  var cos2h = dotNH.pow2();\n  var sin2h = cos2h.oneMinus().max(0.0078125); // 2^(-14/2), so sin2h^2 > 0 in fp16\n\n  return float(2.0).add(invAlpha).mul(sin2h.pow(invAlpha.mul(0.5))).div(2.0 * Math.PI);\n};\n\n// https://github.com/google/filament/blob/master/shaders/src/brdf.fs\nvar V_Neubelt = function V_Neubelt(dotNV, dotNL) {\n  // Neubelt and Pettineo 2013, \"Crafting a Next-gen Material Pipeline for The Order: 1886\"\n  return float(1.0).div(float(4.0).mul(dotNL.add(dotNV).sub(dotNL.mul(dotNV))));\n};\nvar BRDF_Sheen = tslFn(function (_ref) {\n  var lightDirection = _ref.lightDirection;\n  var halfDir = lightDirection.add(positionViewDirection).normalize();\n  var dotNL = transformedNormalView.dot(lightDirection).clamp();\n  var dotNV = transformedNormalView.dot(positionViewDirection).clamp();\n  var dotNH = transformedNormalView.dot(halfDir).clamp();\n  var D = D_Charlie(sheenRoughness, dotNH);\n  var V = V_Neubelt(dotNV, dotNL);\n  return sheen.mul(D).mul(V);\n});\nexport default BRDF_Sheen;","map":{"version":3,"names":["transformedNormalView","positionViewDirection","sheen","sheenRoughness","tslFn","float","D_Charlie","roughness","dotNH","alpha","pow2","invAlpha","div","cos2h","sin2h","oneMinus","max","add","mul","pow","Math","PI","V_Neubelt","dotNV","dotNL","sub","BRDF_Sheen","_ref","lightDirection","halfDir","normalize","dot","clamp","D","V"],"sources":["/home/darkadius/ros2_ws/src/BotshareWIP/ROS2/robotui/node_modules/three/examples/jsm/nodes/functions/BSDF/BRDF_Sheen.js"],"sourcesContent":["import { transformedNormalView } from '../../accessors/NormalNode.js';\nimport { positionViewDirection } from '../../accessors/PositionNode.js';\nimport { sheen, sheenRoughness } from '../../core/PropertyNode.js';\nimport { tslFn, float } from '../../shadernode/ShaderNode.js';\n\n// https://github.com/google/filament/blob/master/shaders/src/brdf.fs\nconst D_Charlie = ( roughness, dotNH ) => {\n\n\tconst alpha = roughness.pow2();\n\n\t// Estevez and Kulla 2017, \"Production Friendly Microfacet Sheen BRDF\"\n\tconst invAlpha = float( 1.0 ).div( alpha );\n\tconst cos2h = dotNH.pow2();\n\tconst sin2h = cos2h.oneMinus().max( 0.0078125 ); // 2^(-14/2), so sin2h^2 > 0 in fp16\n\n\treturn float( 2.0 ).add( invAlpha ).mul( sin2h.pow( invAlpha.mul( 0.5 ) ) ).div( 2.0 * Math.PI );\n\n};\n\n// https://github.com/google/filament/blob/master/shaders/src/brdf.fs\nconst V_Neubelt = ( dotNV, dotNL ) => {\n\n\t// Neubelt and Pettineo 2013, \"Crafting a Next-gen Material Pipeline for The Order: 1886\"\n\treturn float( 1.0 ).div( float( 4.0 ).mul( dotNL.add( dotNV ).sub( dotNL.mul( dotNV ) ) ) );\n\n};\n\nconst BRDF_Sheen = tslFn( ( { lightDirection } ) => {\n\n\tconst halfDir = lightDirection.add( positionViewDirection ).normalize();\n\n\tconst dotNL = transformedNormalView.dot( lightDirection ).clamp();\n\tconst dotNV = transformedNormalView.dot( positionViewDirection ).clamp();\n\tconst dotNH = transformedNormalView.dot( halfDir ).clamp();\n\n\tconst D = D_Charlie( sheenRoughness, dotNH );\n\tconst V = V_Neubelt( dotNV, dotNL );\n\n\treturn sheen.mul( D ).mul( V );\n\n} );\n\nexport default BRDF_Sheen;\n"],"mappings":"AAAA,SAASA,qBAAqB,QAAQ,+BAA+B;AACrE,SAASC,qBAAqB,QAAQ,iCAAiC;AACvE,SAASC,KAAK,EAAEC,cAAc,QAAQ,4BAA4B;AAClE,SAASC,KAAK,EAAEC,KAAK,QAAQ,gCAAgC;;AAE7D;AACA,IAAMC,SAAS,GAAG,SAAZA,SAASA,CAAKC,SAAS,EAAEC,KAAK,EAAM;EAEzC,IAAMC,KAAK,GAAGF,SAAS,CAACG,IAAI,CAAC,CAAC;;EAE9B;EACA,IAAMC,QAAQ,GAAGN,KAAK,CAAE,GAAI,CAAC,CAACO,GAAG,CAAEH,KAAM,CAAC;EAC1C,IAAMI,KAAK,GAAGL,KAAK,CAACE,IAAI,CAAC,CAAC;EAC1B,IAAMI,KAAK,GAAGD,KAAK,CAACE,QAAQ,CAAC,CAAC,CAACC,GAAG,CAAE,SAAU,CAAC,CAAC,CAAC;;EAEjD,OAAOX,KAAK,CAAE,GAAI,CAAC,CAACY,GAAG,CAAEN,QAAS,CAAC,CAACO,GAAG,CAAEJ,KAAK,CAACK,GAAG,CAAER,QAAQ,CAACO,GAAG,CAAE,GAAI,CAAE,CAAE,CAAC,CAACN,GAAG,CAAE,GAAG,GAAGQ,IAAI,CAACC,EAAG,CAAC;AAEjG,CAAC;;AAED;AACA,IAAMC,SAAS,GAAG,SAAZA,SAASA,CAAKC,KAAK,EAAEC,KAAK,EAAM;EAErC;EACA,OAAOnB,KAAK,CAAE,GAAI,CAAC,CAACO,GAAG,CAAEP,KAAK,CAAE,GAAI,CAAC,CAACa,GAAG,CAAEM,KAAK,CAACP,GAAG,CAAEM,KAAM,CAAC,CAACE,GAAG,CAAED,KAAK,CAACN,GAAG,CAAEK,KAAM,CAAE,CAAE,CAAE,CAAC;AAE5F,CAAC;AAED,IAAMG,UAAU,GAAGtB,KAAK,CAAE,UAAAuB,IAAA,EAA0B;EAAA,IAAtBC,cAAc,GAAAD,IAAA,CAAdC,cAAc;EAE3C,IAAMC,OAAO,GAAGD,cAAc,CAACX,GAAG,CAAEhB,qBAAsB,CAAC,CAAC6B,SAAS,CAAC,CAAC;EAEvE,IAAMN,KAAK,GAAGxB,qBAAqB,CAAC+B,GAAG,CAAEH,cAAe,CAAC,CAACI,KAAK,CAAC,CAAC;EACjE,IAAMT,KAAK,GAAGvB,qBAAqB,CAAC+B,GAAG,CAAE9B,qBAAsB,CAAC,CAAC+B,KAAK,CAAC,CAAC;EACxE,IAAMxB,KAAK,GAAGR,qBAAqB,CAAC+B,GAAG,CAAEF,OAAQ,CAAC,CAACG,KAAK,CAAC,CAAC;EAE1D,IAAMC,CAAC,GAAG3B,SAAS,CAAEH,cAAc,EAAEK,KAAM,CAAC;EAC5C,IAAM0B,CAAC,GAAGZ,SAAS,CAAEC,KAAK,EAAEC,KAAM,CAAC;EAEnC,OAAOtB,KAAK,CAACgB,GAAG,CAAEe,CAAE,CAAC,CAACf,GAAG,CAAEgB,CAAE,CAAC;AAE/B,CAAE,CAAC;AAEH,eAAeR,UAAU"},"metadata":{},"sourceType":"module","externalDependencies":[]}