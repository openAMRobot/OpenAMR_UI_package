{"ast":null,"code":"import _construct from \"/home/darkadius/ros2_ws/src/BotshareWIP/ROS2/robotui/node_modules/@babel/runtime/helpers/esm/construct.js\";\nimport _regeneratorRuntime from \"/home/darkadius/ros2_ws/src/BotshareWIP/ROS2/robotui/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/home/darkadius/ros2_ws/src/BotshareWIP/ROS2/robotui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _createForOfIteratorHelper from \"/home/darkadius/ros2_ws/src/BotshareWIP/ROS2/robotui/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport _assertThisInitialized from \"/home/darkadius/ros2_ws/src/BotshareWIP/ROS2/robotui/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";\nimport _classCallCheck from \"/home/darkadius/ros2_ws/src/BotshareWIP/ROS2/robotui/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/home/darkadius/ros2_ws/src/BotshareWIP/ROS2/robotui/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _get from \"/home/darkadius/ros2_ws/src/BotshareWIP/ROS2/robotui/node_modules/@babel/runtime/helpers/esm/get.js\";\nimport _getPrototypeOf from \"/home/darkadius/ros2_ws/src/BotshareWIP/ROS2/robotui/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js\";\nimport _inherits from \"/home/darkadius/ros2_ws/src/BotshareWIP/ROS2/robotui/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"/home/darkadius/ros2_ws/src/BotshareWIP/ROS2/robotui/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport _wrapNativeSuper from \"/home/darkadius/ros2_ws/src/BotshareWIP/ROS2/robotui/node_modules/@babel/runtime/helpers/esm/wrapNativeSuper.js\";\nimport Node, { addNodeClass } from '../core/Node.js';\nimport { scriptableValue } from './ScriptableValueNode.js';\nimport { addNodeElement, nodeProxy, float } from '../shadernode/ShaderNode.js';\nvar Resources = /*#__PURE__*/function (_Map) {\n  _inherits(Resources, _Map);\n  var _super = _createSuper(Resources);\n  function Resources() {\n    _classCallCheck(this, Resources);\n    return _super.apply(this, arguments);\n  }\n  _createClass(Resources, [{\n    key: \"get\",\n    value: function get(key) {\n      var callback = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n      if (this.has(key)) return _get(_getPrototypeOf(Resources.prototype), \"get\", this).call(this, key);\n      if (callback !== null) {\n        for (var _len = arguments.length, params = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n          params[_key - 2] = arguments[_key];\n        }\n        var value = callback.apply(void 0, params);\n        this.set(key, value);\n        return value;\n      }\n    }\n  }]);\n  return Resources;\n}( /*#__PURE__*/_wrapNativeSuper(Map));\nvar Parameters = /*#__PURE__*/function () {\n  function Parameters(scriptableNode) {\n    _classCallCheck(this, Parameters);\n    this.scriptableNode = scriptableNode;\n  }\n  _createClass(Parameters, [{\n    key: \"parameters\",\n    get: function get() {\n      return this.scriptableNode.parameters;\n    }\n  }, {\n    key: \"layout\",\n    get: function get() {\n      return this.scriptableNode.getLayout();\n    }\n  }, {\n    key: \"getInputLayout\",\n    value: function getInputLayout(id) {\n      return this.scriptableNode.getInputLayout(id);\n    }\n  }, {\n    key: \"get\",\n    value: function get(name) {\n      var param = this.parameters[name];\n      var value = param ? param.getValue() : null;\n      return value;\n    }\n  }]);\n  return Parameters;\n}();\nexport var global = new Resources();\nvar ScriptableNode = /*#__PURE__*/function (_Node) {\n  _inherits(ScriptableNode, _Node);\n  var _super2 = _createSuper(ScriptableNode);\n  function ScriptableNode() {\n    var _this;\n    var codeNode = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n    var parameters = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    _classCallCheck(this, ScriptableNode);\n    _this = _super2.call(this);\n    _this.codeNode = codeNode;\n    _this.parameters = parameters;\n    _this._local = new Resources();\n    _this._output = scriptableValue();\n    _this._outputs = {};\n    _this._source = _this.source;\n    _this._method = null;\n    _this._object = null;\n    _this._value = null;\n    _this._needsOutputUpdate = true;\n    _this.onRefresh = _this.onRefresh.bind(_assertThisInitialized(_this));\n    _this.isScriptableNode = true;\n    return _this;\n  }\n  _createClass(ScriptableNode, [{\n    key: \"source\",\n    get: function get() {\n      return this.codeNode ? this.codeNode.code : '';\n    }\n  }, {\n    key: \"setLocal\",\n    value: function setLocal(name, value) {\n      return this._local.set(name, value);\n    }\n  }, {\n    key: \"getLocal\",\n    value: function getLocal(name) {\n      return this._local.get(name);\n    }\n  }, {\n    key: \"onRefresh\",\n    value: function onRefresh() {\n      this._refresh();\n    }\n  }, {\n    key: \"getInputLayout\",\n    value: function getInputLayout(id) {\n      var _iterator = _createForOfIteratorHelper(this.getLayout()),\n        _step;\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var element = _step.value;\n          if (element.inputType && (element.id === id || element.name === id)) {\n            return element;\n          }\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n    }\n  }, {\n    key: \"getOutputLayout\",\n    value: function getOutputLayout(id) {\n      var _iterator2 = _createForOfIteratorHelper(this.getLayout()),\n        _step2;\n      try {\n        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n          var element = _step2.value;\n          if (element.outputType && (element.id === id || element.name === id)) {\n            return element;\n          }\n        }\n      } catch (err) {\n        _iterator2.e(err);\n      } finally {\n        _iterator2.f();\n      }\n    }\n  }, {\n    key: \"setOutput\",\n    value: function setOutput(name, value) {\n      var outputs = this._outputs;\n      if (outputs[name] === undefined) {\n        outputs[name] = scriptableValue(value);\n      } else {\n        outputs[name].value = value;\n      }\n      return this;\n    }\n  }, {\n    key: \"getOutput\",\n    value: function getOutput(name) {\n      return this._outputs[name];\n    }\n  }, {\n    key: \"getParameter\",\n    value: function getParameter(name) {\n      return this.parameters[name];\n    }\n  }, {\n    key: \"setParameter\",\n    value: function setParameter(name, value) {\n      var parameters = this.parameters;\n      if (value && value.isScriptableNode) {\n        this.deleteParameter(name);\n        parameters[name] = value;\n        parameters[name].getDefaultOutput().events.addEventListener('refresh', this.onRefresh);\n      } else if (value && value.isScriptableValueNode) {\n        this.deleteParameter(name);\n        parameters[name] = value;\n        parameters[name].events.addEventListener('refresh', this.onRefresh);\n      } else if (parameters[name] === undefined) {\n        parameters[name] = scriptableValue(value);\n        parameters[name].events.addEventListener('refresh', this.onRefresh);\n      } else {\n        parameters[name].value = value;\n      }\n      return this;\n    }\n  }, {\n    key: \"getValue\",\n    value: function getValue() {\n      return this.getDefaultOutput().getValue();\n    }\n  }, {\n    key: \"deleteParameter\",\n    value: function deleteParameter(name) {\n      var valueNode = this.parameters[name];\n      if (valueNode) {\n        if (valueNode.isScriptableNode) valueNode = valueNode.getDefaultOutput();\n        valueNode.events.removeEventListener('refresh', this.onRefresh);\n      }\n      return this;\n    }\n  }, {\n    key: \"clearParameters\",\n    value: function clearParameters() {\n      for (var _i = 0, _Object$keys = Object.keys(this.parameters); _i < _Object$keys.length; _i++) {\n        var name = _Object$keys[_i];\n        this.deleteParameter(name);\n      }\n      this.needsUpdate = true;\n      return this;\n    }\n  }, {\n    key: \"call\",\n    value: function call(name) {\n      var object = this.getObject();\n      var method = object[name];\n      if (typeof method === 'function') {\n        for (var _len2 = arguments.length, params = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n          params[_key2 - 1] = arguments[_key2];\n        }\n        return method.apply(void 0, params);\n      }\n    }\n  }, {\n    key: \"callAsync\",\n    value: function () {\n      var _callAsync = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(name) {\n        var object,\n          method,\n          _len3,\n          params,\n          _key3,\n          _args = arguments;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              object = this.getObject();\n              method = object[name];\n              if (!(typeof method === 'function')) {\n                _context.next = 12;\n                break;\n              }\n              for (_len3 = _args.length, params = new Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {\n                params[_key3 - 1] = _args[_key3];\n              }\n              if (!(method.constructor.name === 'AsyncFunction')) {\n                _context.next = 10;\n                break;\n              }\n              _context.next = 7;\n              return method.apply(void 0, params);\n            case 7:\n              _context.t0 = _context.sent;\n              _context.next = 11;\n              break;\n            case 10:\n              _context.t0 = method.apply(void 0, params);\n            case 11:\n              return _context.abrupt(\"return\", _context.t0);\n            case 12:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this);\n      }));\n      function callAsync(_x) {\n        return _callAsync.apply(this, arguments);\n      }\n      return callAsync;\n    }()\n  }, {\n    key: \"getNodeType\",\n    value: function getNodeType(builder) {\n      return this.getDefaultOutputNode().getNodeType(builder);\n    }\n  }, {\n    key: \"refresh\",\n    value: function refresh() {\n      var output = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n      if (output !== null) {\n        this.getOutput(output).refresh();\n      } else {\n        this._refresh();\n      }\n    }\n  }, {\n    key: \"getObject\",\n    value: function getObject() {\n      var _this2 = this;\n      if (this.needsUpdate) this.dispose();\n      if (this._object !== null) return this._object;\n\n      //\n\n      var refresh = function refresh() {\n        return _this2.refresh();\n      };\n      var setOutput = function setOutput(id, value) {\n        return _this2.setOutput(id, value);\n      };\n      var parameters = new Parameters(this);\n      var THREE = global.get('THREE');\n      var TSL = global.get('TSL');\n      var method = this.getMethod(this.codeNode);\n      var params = [parameters, this._local, global, refresh, setOutput, THREE, TSL];\n      this._object = method.apply(void 0, params);\n      var layout = this._object.layout;\n      if (layout) {\n        if (layout.cache === false) {\n          this._local.clear();\n        }\n\n        // default output\n        this._output.outputType = layout.outputType || null;\n        if (Array.isArray(layout.elements)) {\n          var _iterator3 = _createForOfIteratorHelper(layout.elements),\n            _step3;\n          try {\n            for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n              var element = _step3.value;\n              var id = element.id || element.name;\n              if (element.inputType) {\n                if (this.getParameter(id) === undefined) this.setParameter(id, null);\n                this.getParameter(id).inputType = element.inputType;\n              }\n              if (element.outputType) {\n                if (this.getOutput(id) === undefined) this.setOutput(id, null);\n                this.getOutput(id).outputType = element.outputType;\n              }\n            }\n          } catch (err) {\n            _iterator3.e(err);\n          } finally {\n            _iterator3.f();\n          }\n        }\n      }\n      return this._object;\n    }\n  }, {\n    key: \"deserialize\",\n    value: function deserialize(data) {\n      _get(_getPrototypeOf(ScriptableNode.prototype), \"deserialize\", this).call(this, data);\n      for (var name in this.parameters) {\n        var valueNode = this.parameters[name];\n        if (valueNode.isScriptableNode) valueNode = valueNode.getDefaultOutput();\n        valueNode.events.addEventListener('refresh', this.onRefresh);\n      }\n    }\n  }, {\n    key: \"getLayout\",\n    value: function getLayout() {\n      return this.getObject().layout;\n    }\n  }, {\n    key: \"getDefaultOutputNode\",\n    value: function getDefaultOutputNode() {\n      var output = this.getDefaultOutput().value;\n      if (output && output.isNode) {\n        return output;\n      }\n      return float();\n    }\n  }, {\n    key: \"getDefaultOutput\",\n    value: function getDefaultOutput() {\n      return this._exec()._output;\n    }\n  }, {\n    key: \"getMethod\",\n    value: function getMethod() {\n      if (this.needsUpdate) this.dispose();\n      if (this._method !== null) return this._method;\n\n      //\n\n      var parametersProps = ['parameters', 'local', 'global', 'refresh', 'setOutput', 'THREE', 'TSL'];\n      var interfaceProps = ['layout', 'init', 'main', 'dispose'];\n      var properties = interfaceProps.join(', ');\n      var declarations = 'var ' + properties + '; var output = {};\\n';\n      var returns = '\\nreturn { ...output, ' + properties + ' };';\n      var code = declarations + this.codeNode.code + returns;\n\n      //\n\n      this._method = _construct(Function, parametersProps.concat([code]));\n      return this._method;\n    }\n  }, {\n    key: \"dispose\",\n    value: function dispose() {\n      if (this._method === null) return;\n      if (this._object && typeof this._object.dispose === 'function') {\n        this._object.dispose();\n      }\n      this._method = null;\n      this._object = null;\n      this._source = null;\n      this._value = null;\n      this._needsOutputUpdate = true;\n      this._output.value = null;\n      this._outputs = {};\n    }\n  }, {\n    key: \"setup\",\n    value: function setup() {\n      return this.getDefaultOutputNode();\n    }\n  }, {\n    key: \"needsUpdate\",\n    get: function get() {\n      return this.source !== this._source;\n    },\n    set: function set(value) {\n      if (value === true) this.dispose();\n    }\n  }, {\n    key: \"_exec\",\n    value: function _exec() {\n      if (this.codeNode === null) return this;\n      if (this._needsOutputUpdate === true) {\n        this._value = this.call('main');\n        this._needsOutputUpdate = false;\n      }\n      this._output.value = this._value;\n      return this;\n    }\n  }, {\n    key: \"_refresh\",\n    value: function _refresh() {\n      this.needsUpdate = true;\n      this._exec();\n      this._output.refresh();\n    }\n  }]);\n  return ScriptableNode;\n}(Node);\nexport default ScriptableNode;\nexport var scriptable = nodeProxy(ScriptableNode);\naddNodeElement('scriptable', scriptable);\naddNodeClass('ScriptableNode', ScriptableNode);","map":{"version":3,"names":["Node","addNodeClass","scriptableValue","addNodeElement","nodeProxy","float","Resources","_Map","_inherits","_super","_createSuper","_classCallCheck","apply","arguments","_createClass","key","value","get","callback","length","undefined","has","_get","_getPrototypeOf","prototype","call","_len","params","Array","_key","set","_wrapNativeSuper","Map","Parameters","scriptableNode","parameters","getLayout","getInputLayout","id","name","param","getValue","global","ScriptableNode","_Node","_super2","_this","codeNode","_local","_output","_outputs","_source","source","_method","_object","_value","_needsOutputUpdate","onRefresh","bind","_assertThisInitialized","isScriptableNode","code","setLocal","getLocal","_refresh","_iterator","_createForOfIteratorHelper","_step","s","n","done","element","inputType","err","e","f","getOutputLayout","_iterator2","_step2","outputType","setOutput","outputs","getOutput","getParameter","setParameter","deleteParameter","getDefaultOutput","events","addEventListener","isScriptableValueNode","valueNode","removeEventListener","clearParameters","_i","_Object$keys","Object","keys","needsUpdate","object","getObject","method","_len2","_key2","_callAsync","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_len3","_key3","_args","wrap","_callee$","_context","prev","next","constructor","t0","sent","abrupt","stop","callAsync","_x","getNodeType","builder","getDefaultOutputNode","refresh","output","_this2","dispose","THREE","TSL","getMethod","layout","cache","clear","isArray","elements","_iterator3","_step3","deserialize","data","isNode","_exec","parametersProps","interfaceProps","properties","join","declarations","returns","_construct","Function","concat","setup","scriptable"],"sources":["/home/darkadius/ros2_ws/src/BotshareWIP/ROS2/robotui/node_modules/three/examples/jsm/nodes/code/ScriptableNode.js"],"sourcesContent":["import Node, { addNodeClass } from '../core/Node.js';\nimport { scriptableValue } from './ScriptableValueNode.js';\nimport { addNodeElement, nodeProxy, float } from '../shadernode/ShaderNode.js';\n\nclass Resources extends Map {\n\n\tget( key, callback = null, ...params ) {\n\n\t\tif ( this.has( key ) ) return super.get( key );\n\n\t\tif ( callback !== null ) {\n\n\t\t\tconst value = callback( ...params );\n\t\t\tthis.set( key, value );\n\t\t\treturn value;\n\n\t\t}\n\n\t}\n\n}\n\nclass Parameters {\n\n\tconstructor( scriptableNode ) {\n\n\t\tthis.scriptableNode = scriptableNode;\n\n\t}\n\n\tget parameters() {\n\n\t\treturn this.scriptableNode.parameters;\n\n\t}\n\n\tget layout() {\n\n\t\treturn this.scriptableNode.getLayout();\n\n\t}\n\n\tgetInputLayout( id ) {\n\n\t\treturn this.scriptableNode.getInputLayout( id );\n\n\t}\n\n\tget( name ) {\n\n\t\tconst param = this.parameters[ name ];\n\t\tconst value = param ? param.getValue() : null;\n\n\t\treturn value;\n\n\t}\n\n}\n\nexport const global = new Resources();\n\nclass ScriptableNode extends Node {\n\n\tconstructor( codeNode = null, parameters = {} ) {\n\n\t\tsuper();\n\n\t\tthis.codeNode = codeNode;\n\t\tthis.parameters = parameters;\n\n\t\tthis._local = new Resources();\n\t\tthis._output = scriptableValue();\n\t\tthis._outputs = {};\n\t\tthis._source = this.source;\n\t\tthis._method = null;\n\t\tthis._object = null;\n\t\tthis._value = null;\n\t\tthis._needsOutputUpdate = true;\n\n\t\tthis.onRefresh = this.onRefresh.bind( this );\n\n\t\tthis.isScriptableNode = true;\n\n\t}\n\n\tget source() {\n\n\t\treturn this.codeNode ? this.codeNode.code : '';\n\n\t}\n\n\tsetLocal( name, value ) {\n\n\t\treturn this._local.set( name, value );\n\n\t}\n\n\tgetLocal( name ) {\n\n\t\treturn this._local.get( name );\n\n\t}\n\n\tonRefresh() {\n\n\t\tthis._refresh();\n\n\t}\n\n\tgetInputLayout( id ) {\n\n\t\tfor ( const element of this.getLayout() ) {\n\n\t\t\tif ( element.inputType && ( element.id === id || element.name === id ) ) {\n\n\t\t\t\treturn element;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tgetOutputLayout( id ) {\n\n\t\tfor ( const element of this.getLayout() ) {\n\n\t\t\tif ( element.outputType && ( element.id === id || element.name === id ) ) {\n\n\t\t\t\treturn element;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tsetOutput( name, value ) {\n\n\t\tconst outputs = this._outputs;\n\n\t\tif ( outputs[ name ] === undefined ) {\n\n\t\t\toutputs[ name ] = scriptableValue( value );\n\n\t\t} else {\n\n\t\t\toutputs[ name ].value = value;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetOutput( name ) {\n\n\t\treturn this._outputs[ name ];\n\n\t}\n\n\tgetParameter( name ) {\n\n\t\treturn this.parameters[ name ];\n\n\t}\n\n\tsetParameter( name, value ) {\n\n\t\tconst parameters = this.parameters;\n\n\t\tif ( value && value.isScriptableNode ) {\n\n\t\t\tthis.deleteParameter( name );\n\n\t\t\tparameters[ name ] = value;\n\t\t\tparameters[ name ].getDefaultOutput().events.addEventListener( 'refresh', this.onRefresh );\n\n\t\t} else if ( value && value.isScriptableValueNode ) {\n\n\t\t\tthis.deleteParameter( name );\n\n\t\t\tparameters[ name ] = value;\n\t\t\tparameters[ name ].events.addEventListener( 'refresh', this.onRefresh );\n\n\t\t} else if ( parameters[ name ] === undefined ) {\n\n\t\t\tparameters[ name ] = scriptableValue( value );\n\t\t\tparameters[ name ].events.addEventListener( 'refresh', this.onRefresh );\n\n\t\t} else {\n\n\t\t\tparameters[ name ].value = value;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetValue() {\n\n\t\treturn this.getDefaultOutput().getValue();\n\n\t}\n\n\tdeleteParameter( name ) {\n\n\t\tlet valueNode = this.parameters[ name ];\n\n\t\tif ( valueNode ) {\n\n\t\t\tif ( valueNode.isScriptableNode ) valueNode = valueNode.getDefaultOutput();\n\n\t\t\tvalueNode.events.removeEventListener( 'refresh', this.onRefresh );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tclearParameters() {\n\n\t\tfor ( const name of Object.keys( this.parameters ) ) {\n\n\t\t\tthis.deleteParameter( name );\n\n\t\t}\n\n\t\tthis.needsUpdate = true;\n\n\t\treturn this;\n\n\t}\n\n\tcall( name, ...params ) {\n\n\t\tconst object = this.getObject();\n\t\tconst method = object[ name ];\n\n\t\tif ( typeof method === 'function' ) {\n\n\t\t\treturn method( ...params );\n\n\t\t}\n\n\t}\n\n\tasync callAsync( name, ...params ) {\n\n\t\tconst object = this.getObject();\n\t\tconst method = object[ name ];\n\n\t\tif ( typeof method === 'function' ) {\n\n\t\t\treturn method.constructor.name === 'AsyncFunction' ? await method( ...params ) : method( ...params );\n\n\t\t}\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.getDefaultOutputNode().getNodeType( builder );\n\n\t}\n\n\trefresh( output = null ) {\n\n\t\tif ( output !== null ) {\n\n\t\t\tthis.getOutput( output ).refresh();\n\n\t\t} else {\n\n\t\t\tthis._refresh();\n\n\t\t}\n\n\t}\n\n\tgetObject() {\n\n\t\tif ( this.needsUpdate ) this.dispose();\n\t\tif ( this._object !== null ) return this._object;\n\n\t\t//\n\n\t\tconst refresh = () => this.refresh();\n\t\tconst setOutput = ( id, value ) => this.setOutput( id, value );\n\n\t\tconst parameters = new Parameters( this );\n\n\t\tconst THREE = global.get( 'THREE' );\n\t\tconst TSL = global.get( 'TSL' );\n\n\t\tconst method = this.getMethod( this.codeNode );\n\t\tconst params = [ parameters, this._local, global, refresh, setOutput, THREE, TSL ];\n\n\t\tthis._object = method( ...params );\n\n\t\tconst layout = this._object.layout;\n\n\t\tif ( layout ) {\n\n\t\t\tif ( layout.cache === false ) {\n\n\t\t\t\tthis._local.clear();\n\n\t\t\t}\n\n\t\t\t// default output\n\t\t\tthis._output.outputType = layout.outputType || null;\n\n\t\t\tif ( Array.isArray( layout.elements ) ) {\n\n\t\t\t\tfor ( const element of layout.elements ) {\n\n\t\t\t\t\tconst id = element.id || element.name;\n\n\t\t\t\t\tif ( element.inputType ) {\n\n\t\t\t\t\t\tif ( this.getParameter( id ) === undefined ) this.setParameter( id, null );\n\n\t\t\t\t\t\tthis.getParameter( id ).inputType = element.inputType;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( element.outputType ) {\n\n\t\t\t\t\t\tif ( this.getOutput( id ) === undefined ) this.setOutput( id, null );\n\n\t\t\t\t\t\tthis.getOutput( id ).outputType = element.outputType;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this._object;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tfor ( const name in this.parameters ) {\n\n\t\t\tlet valueNode = this.parameters[ name ];\n\n\t\t\tif ( valueNode.isScriptableNode ) valueNode = valueNode.getDefaultOutput();\n\n\t\t\tvalueNode.events.addEventListener( 'refresh', this.onRefresh );\n\n\t\t}\n\n\t}\n\n\tgetLayout() {\n\n\t\treturn this.getObject().layout;\n\n\t}\n\n\tgetDefaultOutputNode() {\n\n\t\tconst output = this.getDefaultOutput().value;\n\n\t\tif ( output && output.isNode ) {\n\n\t\t\treturn output;\n\n\t\t}\n\n\t\treturn float();\n\n\t}\n\n\tgetDefaultOutput()\t{\n\n\t\treturn this._exec()._output;\n\n\t}\n\n\tgetMethod() {\n\n\t\tif ( this.needsUpdate ) this.dispose();\n\t\tif ( this._method !== null ) return this._method;\n\n\t\t//\n\n\t\tconst parametersProps = [ 'parameters', 'local', 'global', 'refresh', 'setOutput', 'THREE', 'TSL' ];\n\t\tconst interfaceProps = [ 'layout', 'init', 'main', 'dispose' ];\n\n\t\tconst properties = interfaceProps.join( ', ' );\n\t\tconst declarations = 'var ' + properties + '; var output = {};\\n';\n\t\tconst returns = '\\nreturn { ...output, ' + properties + ' };';\n\n\t\tconst code = declarations + this.codeNode.code + returns;\n\n\t\t//\n\n\t\tthis._method = new Function( ...parametersProps, code );\n\n\t\treturn this._method;\n\n\t}\n\n\tdispose() {\n\n\t\tif ( this._method === null ) return;\n\n\t\tif ( this._object && typeof this._object.dispose === 'function' ) {\n\n\t\t\tthis._object.dispose();\n\n\t\t}\n\n\t\tthis._method = null;\n\t\tthis._object = null;\n\t\tthis._source = null;\n\t\tthis._value = null;\n\t\tthis._needsOutputUpdate = true;\n\t\tthis._output.value = null;\n\t\tthis._outputs = {};\n\n\t}\n\n\tsetup() {\n\n\t\treturn this.getDefaultOutputNode();\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.dispose();\n\n\t}\n\n\tget needsUpdate() {\n\n\t\treturn this.source !== this._source;\n\n\t}\n\n\t_exec()\t{\n\n\t\tif ( this.codeNode === null ) return this;\n\n\t\tif ( this._needsOutputUpdate === true ) {\n\n\t\t\tthis._value = this.call( 'main' );\n\n\t\t\tthis._needsOutputUpdate = false;\n\n\t\t}\n\n\t\tthis._output.value = this._value;\n\n\t\treturn this;\n\n\t}\n\n\t_refresh() {\n\n\t\tthis.needsUpdate = true;\n\n\t\tthis._exec();\n\n\t\tthis._output.refresh();\n\n\t}\n\n}\n\nexport default ScriptableNode;\n\nexport const scriptable = nodeProxy( ScriptableNode );\n\naddNodeElement( 'scriptable', scriptable );\n\naddNodeClass( 'ScriptableNode', ScriptableNode );\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}