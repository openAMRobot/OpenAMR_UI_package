{"ast":null,"code":"import _slicedToArray from\"/home/darkadius/ros2_ws/src/BotshareWIP/ROS2/robotui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useContext,useRef,useEffect,useState}from\"react\";import{Joystick}from\"react-joystick-component\";import{AppConfig}from\"../shared/constants/index\";import{RosContext}from\"../app/App\";import{jsx as _jsx}from\"react/jsx-runtime\";var interval=null;var JoystickComponent=function JoystickComponent(){var ros=useContext(RosContext);var joysticRef=useRef();var _useState=useState(180),_useState2=_slicedToArray(_useState,2),size=_useState2[0],setSize=_useState2[1];var _useState3=useState(120),_useState4=_slicedToArray(_useState3,2),stickSize=_useState4[0],setStickSize=_useState4[1];var cmdVel=useRef(new window.ROSLIB.Topic({ros:ros,name:AppConfig.CMD_VEL_TOPIC,messageType:\"geometry_msgs/Twist\"}));var setDataToRos=function setDataToRos(coordsData){clearInterval(interval);interval=null;if(!interval){interval=setInterval(function(){var twist_msg=new window.ROSLIB.Message(coordsData);cmdVel.current.publish(twist_msg);},100);}};var handleJoysticMove=function handleJoysticMove(evt){var x=evt.y*AppConfig.MAX_LINEAR_SPEED;var z=-evt.x*AppConfig.MAX_LINEAR_SPEED;setDataToRos({linear:{x:x,y:0,z:0},angular:{x:0,y:0,z:z}});};var handleStop=function handleStop(){clearInterval(interval);interval=null;var zeroCoords={linear:{x:0,y:0,z:0},angular:{x:0,y:0,z:0}};var twist_msg=new window.ROSLIB.Message(zeroCoords);cmdVel.current.publish(twist_msg);};useEffect(function(){var blockWidth=joysticRef.current.getBoundingClientRect().width;setSize(blockWidth);setStickSize(blockWidth*0.66);},[]);return/*#__PURE__*/_jsx(\"div\",{ref:joysticRef,className:\"relative h-[100px] w-[100px] lg:h-[140px] lg:w-[140px] 2xl:h-[180px] 2xl:w-[180px]\",children:/*#__PURE__*/_jsx(\"div\",{className:\"absolute\",children:/*#__PURE__*/_jsx(Joystick,{throttle:150,size:size,stickSize:stickSize,baseColor:\"#F5F5F5\",stickColor:\"#22b7fc\",move:function move(evt){return handleJoysticMove(evt);},stop:handleStop})})});};export default JoystickComponent;","map":{"version":3,"names":["React","useContext","useRef","useEffect","useState","Joystick","AppConfig","RosContext","jsx","_jsx","interval","JoystickComponent","ros","joysticRef","_useState","_useState2","_slicedToArray","size","setSize","_useState3","_useState4","stickSize","setStickSize","cmdVel","window","ROSLIB","Topic","name","CMD_VEL_TOPIC","messageType","setDataToRos","coordsData","clearInterval","setInterval","twist_msg","Message","current","publish","handleJoysticMove","evt","x","y","MAX_LINEAR_SPEED","z","linear","angular","handleStop","zeroCoords","blockWidth","getBoundingClientRect","width","ref","className","children","throttle","baseColor","stickColor","move","stop"],"sources":["/home/darkadius/ros2_ws/src/BotshareWIP/ROS2/robotui/src/components/Joystick.jsx"],"sourcesContent":["import React, { useContext, useRef, useEffect, useState } from \"react\";\nimport { Joystick } from \"react-joystick-component\";\n\nimport { AppConfig } from \"../shared/constants/index\";\nimport { RosContext } from \"../app/App\";\n\nlet interval = null;\n\nconst JoystickComponent = () => {\n  const ros = useContext(RosContext);\n  const joysticRef = useRef();\n  const [size, setSize] = useState(180);\n  const [stickSize, setStickSize] = useState(120);\n\n  const cmdVel = useRef(\n    new window.ROSLIB.Topic({\n      ros,\n      name: AppConfig.CMD_VEL_TOPIC,\n      messageType: \"geometry_msgs/Twist\",\n    }),\n  );\n\n  const setDataToRos = (coordsData) => {\n    clearInterval(interval);\n    interval = null;\n\n    if (!interval) {\n      interval = setInterval(() => {\n        const twist_msg = new window.ROSLIB.Message(coordsData);\n        cmdVel.current.publish(twist_msg);\n      }, 100);\n    }\n  };\n\n  const handleJoysticMove = (evt) => {\n    let x = evt.y * AppConfig.MAX_LINEAR_SPEED;\n    let z = -evt.x * AppConfig.MAX_LINEAR_SPEED;\n\n    setDataToRos({\n      linear: {\n        x,\n        y: 0,\n        z: 0,\n      },\n      angular: {\n        x: 0,\n        y: 0,\n        z,\n      },\n    });\n  };\n  const handleStop = () => {\n    clearInterval(interval);\n    interval = null;\n    const zeroCoords = {\n      linear: {\n        x: 0,\n        y: 0,\n        z: 0,\n      },\n      angular: {\n        x: 0,\n        y: 0,\n        z: 0,\n      },\n    };\n    const twist_msg = new window.ROSLIB.Message(zeroCoords);\n    cmdVel.current.publish(twist_msg);\n  };\n\n  useEffect(() => {\n    const blockWidth = joysticRef.current.getBoundingClientRect().width;\n    setSize(blockWidth);\n    setStickSize(blockWidth * 0.66);\n  }, []);\n\n  return (\n    <div\n      ref={joysticRef}\n      className=\"relative h-[100px] w-[100px] lg:h-[140px] lg:w-[140px] 2xl:h-[180px] 2xl:w-[180px]\"\n    >\n      <div className=\"absolute\">\n        <Joystick\n          throttle={150}\n          size={size}\n          stickSize={stickSize}\n          baseColor=\"#F5F5F5\"\n          stickColor=\"#22b7fc\"\n          move={(evt) => handleJoysticMove(evt)}\n          stop={handleStop}\n        />\n      </div>\n    </div>\n  );\n};\n\nexport default JoystickComponent;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}