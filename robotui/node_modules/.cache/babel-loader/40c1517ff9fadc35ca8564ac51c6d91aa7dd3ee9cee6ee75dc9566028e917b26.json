{"ast":null,"code":"import _classCallCheck from \"/home/darkadius/ros2_ws/src/BotshareWIP/ROS2/robotui/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/home/darkadius/ros2_ws/src/BotshareWIP/ROS2/robotui/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _get from \"/home/darkadius/ros2_ws/src/BotshareWIP/ROS2/robotui/node_modules/@babel/runtime/helpers/esm/get.js\";\nimport _getPrototypeOf from \"/home/darkadius/ros2_ws/src/BotshareWIP/ROS2/robotui/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js\";\nimport _inherits from \"/home/darkadius/ros2_ws/src/BotshareWIP/ROS2/robotui/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"/home/darkadius/ros2_ws/src/BotshareWIP/ROS2/robotui/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport _defineProperty from \"/home/darkadius/ros2_ws/src/BotshareWIP/ROS2/robotui/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nvar _toneMappingLib;\nimport TempNode from '../core/TempNode.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { tslFn, nodeObject, float, mat3 } from '../shadernode/ShaderNode.js';\nimport { NoToneMapping, LinearToneMapping, ReinhardToneMapping, CineonToneMapping, ACESFilmicToneMapping } from 'three';\n\n// exposure only\nvar LinearToneMappingNode = tslFn(function (_ref) {\n  var color = _ref.color,\n    exposure = _ref.exposure;\n  return color.mul(exposure).clamp();\n});\n\n// source: https://www.cs.utah.edu/docs/techreports/2002/pdf/UUCS-02-001.pdf\nvar ReinhardToneMappingNode = tslFn(function (_ref2) {\n  var color = _ref2.color,\n    exposure = _ref2.exposure;\n  color = color.mul(exposure);\n  return color.div(color.add(1.0)).clamp();\n});\n\n// source: http://filmicworlds.com/blog/filmic-tonemapping-operators/\nvar OptimizedCineonToneMappingNode = tslFn(function (_ref3) {\n  var color = _ref3.color,\n    exposure = _ref3.exposure;\n  // optimized filmic operator by Jim Hejl and Richard Burgess-Dawson\n  color = color.mul(exposure);\n  color = color.sub(0.004).max(0.0);\n  var a = color.mul(color.mul(6.2).add(0.5));\n  var b = color.mul(color.mul(6.2).add(1.7)).add(0.06);\n  return a.div(b).pow(2.2);\n});\n\n// source: https://github.com/selfshadow/ltc_code/blob/master/webgl/shaders/ltc/ltc_blit.fs\nvar RRTAndODTFit = tslFn(function (_ref4) {\n  var color = _ref4.color;\n  var a = color.mul(color.add(0.0245786)).sub(0.000090537);\n  var b = color.mul(color.add(0.4329510).mul(0.983729)).add(0.238081);\n  return a.div(b);\n});\n\n// source: https://github.com/selfshadow/ltc_code/blob/master/webgl/shaders/ltc/ltc_blit.fs\nvar ACESFilmicToneMappingNode = tslFn(function (_ref5) {\n  var color = _ref5.color,\n    exposure = _ref5.exposure;\n  // sRGB => XYZ => D65_2_D60 => AP1 => RRT_SAT\n  var ACESInputMat = mat3(0.59719, 0.35458, 0.04823, 0.07600, 0.90834, 0.01566, 0.02840, 0.13383, 0.83777);\n\n  // ODT_SAT => XYZ => D60_2_D65 => sRGB\n  var ACESOutputMat = mat3(1.60475, -0.53108, -0.07367, -0.10208, 1.10813, -0.00605, -0.00327, -0.07276, 1.07602);\n  color = color.mul(exposure).div(0.6);\n  color = ACESInputMat.mul(color);\n\n  // Apply RRT and ODT\n  color = RRTAndODTFit({\n    color: color\n  });\n  color = ACESOutputMat.mul(color);\n\n  // Clamp to [0, 1]\n  return color.clamp();\n});\nvar toneMappingLib = (_toneMappingLib = {}, _defineProperty(_toneMappingLib, LinearToneMapping, LinearToneMappingNode), _defineProperty(_toneMappingLib, ReinhardToneMapping, ReinhardToneMappingNode), _defineProperty(_toneMappingLib, CineonToneMapping, OptimizedCineonToneMappingNode), _defineProperty(_toneMappingLib, ACESFilmicToneMapping, ACESFilmicToneMappingNode), _toneMappingLib);\nvar ToneMappingNode = /*#__PURE__*/function (_TempNode) {\n  _inherits(ToneMappingNode, _TempNode);\n  var _super = _createSuper(ToneMappingNode);\n  function ToneMappingNode() {\n    var _this;\n    var toneMapping = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : NoToneMapping;\n    var exposureNode = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : float(1);\n    var colorNode = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    _classCallCheck(this, ToneMappingNode);\n    _this = _super.call(this, 'vec3');\n    _this.toneMapping = toneMapping;\n    _this.exposureNode = exposureNode;\n    _this.colorNode = colorNode;\n    return _this;\n  }\n  _createClass(ToneMappingNode, [{\n    key: \"getCacheKey\",\n    value: function getCacheKey() {\n      var cacheKey = _get(_getPrototypeOf(ToneMappingNode.prototype), \"getCacheKey\", this).call(this);\n      cacheKey = '{toneMapping:' + this.toneMapping + ',nodes:' + cacheKey + '}';\n      return cacheKey;\n    }\n  }, {\n    key: \"setup\",\n    value: function setup(builder) {\n      var colorNode = this.colorNode || builder.context.color;\n      var toneMapping = this.toneMapping;\n      if (toneMapping === NoToneMapping) return colorNode;\n      var toneMappingParams = {\n        exposure: this.exposureNode,\n        color: colorNode\n      };\n      var toneMappingNode = toneMappingLib[toneMapping];\n      var outputNode = null;\n      if (toneMappingNode) {\n        outputNode = toneMappingNode(toneMappingParams);\n      } else {\n        console.error('ToneMappingNode: Unsupported Tone Mapping configuration.', toneMapping);\n        outputNode = colorNode;\n      }\n      return outputNode;\n    }\n  }]);\n  return ToneMappingNode;\n}(TempNode);\nexport default ToneMappingNode;\nexport var toneMapping = function toneMapping(mapping, exposure, color) {\n  return nodeObject(new ToneMappingNode(mapping, nodeObject(exposure), nodeObject(color)));\n};\naddNodeClass('ToneMappingNode', ToneMappingNode);","map":{"version":3,"names":["TempNode","addNodeClass","tslFn","nodeObject","float","mat3","NoToneMapping","LinearToneMapping","ReinhardToneMapping","CineonToneMapping","ACESFilmicToneMapping","LinearToneMappingNode","_ref","color","exposure","mul","clamp","ReinhardToneMappingNode","_ref2","div","add","OptimizedCineonToneMappingNode","_ref3","sub","max","a","b","pow","RRTAndODTFit","_ref4","ACESFilmicToneMappingNode","_ref5","ACESInputMat","ACESOutputMat","toneMappingLib","_toneMappingLib","_defineProperty","ToneMappingNode","_TempNode","_inherits","_super","_createSuper","_this","toneMapping","arguments","length","undefined","exposureNode","colorNode","_classCallCheck","call","_createClass","key","value","getCacheKey","cacheKey","_get","_getPrototypeOf","prototype","setup","builder","context","toneMappingParams","toneMappingNode","outputNode","console","error","mapping"],"sources":["/home/darkadius/ros2_ws/src/BotshareWIP/ROS2/robotui/node_modules/three/examples/jsm/nodes/display/ToneMappingNode.js"],"sourcesContent":["import TempNode from '../core/TempNode.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { tslFn, nodeObject, float, mat3 } from '../shadernode/ShaderNode.js';\n\nimport { NoToneMapping, LinearToneMapping, ReinhardToneMapping, CineonToneMapping, ACESFilmicToneMapping } from 'three';\n\n// exposure only\nconst LinearToneMappingNode = tslFn( ( { color, exposure } ) => {\n\n\treturn color.mul( exposure ).clamp();\n\n} );\n\n// source: https://www.cs.utah.edu/docs/techreports/2002/pdf/UUCS-02-001.pdf\nconst ReinhardToneMappingNode = tslFn( ( { color, exposure } ) => {\n\n\tcolor = color.mul( exposure );\n\n\treturn color.div( color.add( 1.0 ) ).clamp();\n\n} );\n\n// source: http://filmicworlds.com/blog/filmic-tonemapping-operators/\nconst OptimizedCineonToneMappingNode = tslFn( ( { color, exposure } ) => {\n\n\t// optimized filmic operator by Jim Hejl and Richard Burgess-Dawson\n\tcolor = color.mul( exposure );\n\tcolor = color.sub( 0.004 ).max( 0.0 );\n\n\tconst a = color.mul( color.mul( 6.2 ).add( 0.5 ) );\n\tconst b = color.mul( color.mul( 6.2 ).add( 1.7 ) ).add( 0.06 );\n\n\treturn a.div( b ).pow( 2.2 );\n\n} );\n\n// source: https://github.com/selfshadow/ltc_code/blob/master/webgl/shaders/ltc/ltc_blit.fs\nconst RRTAndODTFit = tslFn( ( { color } ) => {\n\n\tconst a = color.mul( color.add( 0.0245786 ) ).sub( 0.000090537 );\n\tconst b = color.mul( color.add( 0.4329510 ).mul( 0.983729 ) ).add( 0.238081 );\n\n\treturn a.div( b );\n\n} );\n\n// source: https://github.com/selfshadow/ltc_code/blob/master/webgl/shaders/ltc/ltc_blit.fs\nconst ACESFilmicToneMappingNode = tslFn( ( { color, exposure } ) => {\n\n\t// sRGB => XYZ => D65_2_D60 => AP1 => RRT_SAT\n\tconst ACESInputMat = mat3(\n\t\t0.59719, 0.35458, 0.04823,\n\t\t0.07600, 0.90834, 0.01566,\n\t\t0.02840, 0.13383, 0.83777\n\t);\n\n\t// ODT_SAT => XYZ => D60_2_D65 => sRGB\n\tconst ACESOutputMat = mat3(\n\t\t1.60475, - 0.53108, - 0.07367,\n\t\t- 0.10208, 1.10813, - 0.00605,\n\t\t- 0.00327, - 0.07276, 1.07602\n\t);\n\n\tcolor = color.mul( exposure ).div( 0.6 );\n\n\tcolor = ACESInputMat.mul( color );\n\n\t// Apply RRT and ODT\n\tcolor = RRTAndODTFit( { color } );\n\n\tcolor = ACESOutputMat.mul( color );\n\n\t// Clamp to [0, 1]\n\treturn color.clamp();\n\n} );\n\nconst toneMappingLib = {\n\t[ LinearToneMapping ]: LinearToneMappingNode,\n\t[ ReinhardToneMapping ]: ReinhardToneMappingNode,\n\t[ CineonToneMapping ]: OptimizedCineonToneMappingNode,\n\t[ ACESFilmicToneMapping ]: ACESFilmicToneMappingNode\n};\n\nclass ToneMappingNode extends TempNode {\n\n\tconstructor( toneMapping = NoToneMapping, exposureNode = float( 1 ), colorNode = null ) {\n\n\t\tsuper( 'vec3' );\n\n\t\tthis.toneMapping = toneMapping;\n\n\t\tthis.exposureNode = exposureNode;\n\t\tthis.colorNode = colorNode;\n\n\t}\n\n\tgetCacheKey() {\n\n\t\tlet cacheKey = super.getCacheKey();\n\t\tcacheKey = '{toneMapping:' + this.toneMapping + ',nodes:' + cacheKey + '}';\n\n\t\treturn cacheKey;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst colorNode = this.colorNode || builder.context.color;\n\t\tconst toneMapping = this.toneMapping;\n\n\t\tif ( toneMapping === NoToneMapping ) return colorNode;\n\n\t\tconst toneMappingParams = { exposure: this.exposureNode, color: colorNode };\n\t\tconst toneMappingNode = toneMappingLib[ toneMapping ];\n\n\t\tlet outputNode = null;\n\n\t\tif ( toneMappingNode ) {\n\n\t\t\toutputNode = toneMappingNode( toneMappingParams );\n\n\t\t} else {\n\n\t\t\tconsole.error( 'ToneMappingNode: Unsupported Tone Mapping configuration.', toneMapping );\n\n\t\t\toutputNode = colorNode;\n\n\t\t}\n\n\t\treturn outputNode;\n\n\t}\n\n}\n\nexport default ToneMappingNode;\n\nexport const toneMapping = ( mapping, exposure, color ) => nodeObject( new ToneMappingNode( mapping, nodeObject( exposure ), nodeObject( color ) ) );\n\naddNodeClass( 'ToneMappingNode', ToneMappingNode );\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}