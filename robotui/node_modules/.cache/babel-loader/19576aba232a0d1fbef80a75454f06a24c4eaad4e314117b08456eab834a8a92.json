{"ast":null,"code":"import _classCallCheck from \"/home/darkadius/ros2_ws/src/BotshareWIP/ROS2/robotui/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/home/darkadius/ros2_ws/src/BotshareWIP/ROS2/robotui/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _get from \"/home/darkadius/ros2_ws/src/BotshareWIP/ROS2/robotui/node_modules/@babel/runtime/helpers/esm/get.js\";\nimport _getPrototypeOf from \"/home/darkadius/ros2_ws/src/BotshareWIP/ROS2/robotui/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js\";\nimport _inherits from \"/home/darkadius/ros2_ws/src/BotshareWIP/ROS2/robotui/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"/home/darkadius/ros2_ws/src/BotshareWIP/ROS2/robotui/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport Node, { addNodeClass } from '../core/Node.js';\nimport { arrayBufferToBase64, base64ToArrayBuffer } from '../core/NodeUtils.js';\nimport { addNodeElement, nodeProxy, float } from '../shadernode/ShaderNode.js';\nimport { EventDispatcher } from 'three';\nvar ScriptableValueNode = /*#__PURE__*/function (_Node) {\n  _inherits(ScriptableValueNode, _Node);\n  var _super = _createSuper(ScriptableValueNode);\n  function ScriptableValueNode() {\n    var _this;\n    var value = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n    _classCallCheck(this, ScriptableValueNode);\n    _this = _super.call(this);\n    _this._value = value;\n    _this._cache = null;\n    _this.inputType = null;\n    _this.outpuType = null;\n    _this.events = new EventDispatcher();\n    _this.isScriptableValueNode = true;\n    return _this;\n  }\n  _createClass(ScriptableValueNode, [{\n    key: \"isScriptableOutputNode\",\n    get: function get() {\n      return this.outputType !== null;\n    }\n  }, {\n    key: \"value\",\n    get: function get() {\n      return this._value;\n    },\n    set: function set(val) {\n      if (this._value === val) return;\n      if (this._cache && this.inputType === 'URL' && this.value.value instanceof ArrayBuffer) {\n        URL.revokeObjectURL(this._cache);\n        this._cache = null;\n      }\n      this._value = val;\n      this.events.dispatchEvent({\n        type: 'change'\n      });\n      this.refresh();\n    }\n  }, {\n    key: \"refresh\",\n    value: function refresh() {\n      this.events.dispatchEvent({\n        type: 'refresh'\n      });\n    }\n  }, {\n    key: \"getValue\",\n    value: function getValue() {\n      var value = this.value;\n      if (value && this._cache === null && this.inputType === 'URL' && value.value instanceof ArrayBuffer) {\n        this._cache = URL.createObjectURL(new Blob([value.value]));\n      } else if (value && value.value !== null && value.value !== undefined && ((this.inputType === 'URL' || this.inputType === 'String') && typeof value.value === 'string' || this.inputType === 'Number' && typeof value.value === 'number' || this.inputType === 'Vector2' && value.value.isVector2 || this.inputType === 'Vector3' && value.value.isVector3 || this.inputType === 'Vector4' && value.value.isVector4 || this.inputType === 'Color' && value.value.isColor || this.inputType === 'Matrix3' && value.value.isMatrix3 || this.inputType === 'Matrix4' && value.value.isMatrix4)) {\n        return value.value;\n      }\n      return this._cache || value;\n    }\n  }, {\n    key: \"getNodeType\",\n    value: function getNodeType(builder) {\n      return this.value && this.value.isNode ? this.value.getNodeType(builder) : 'float';\n    }\n  }, {\n    key: \"setup\",\n    value: function setup() {\n      return this.value && this.value.isNode ? this.value : float();\n    }\n  }, {\n    key: \"serialize\",\n    value: function serialize(data) {\n      _get(_getPrototypeOf(ScriptableValueNode.prototype), \"serialize\", this).call(this, data);\n      if (this.value !== null) {\n        if (this.inputType === 'ArrayBuffer') {\n          data.value = arrayBufferToBase64(this.value);\n        } else {\n          data.value = this.value ? this.value.toJSON(data.meta).uuid : null;\n        }\n      } else {\n        data.value = null;\n      }\n      data.inputType = this.inputType;\n      data.outputType = this.outputType;\n    }\n  }, {\n    key: \"deserialize\",\n    value: function deserialize(data) {\n      _get(_getPrototypeOf(ScriptableValueNode.prototype), \"deserialize\", this).call(this, data);\n      var value = null;\n      if (data.value !== null) {\n        if (data.inputType === 'ArrayBuffer') {\n          value = base64ToArrayBuffer(data.value);\n        } else if (data.inputType === 'Texture') {\n          value = data.meta.textures[data.value];\n        } else {\n          value = data.meta.nodes[data.value] || null;\n        }\n      }\n      this.value = value;\n      this.inputType = data.inputType;\n      this.outputType = data.outputType;\n    }\n  }]);\n  return ScriptableValueNode;\n}(Node);\nexport default ScriptableValueNode;\nexport var scriptableValue = nodeProxy(ScriptableValueNode);\naddNodeElement('scriptableValue', scriptableValue);\naddNodeClass('ScriptableValueNode', ScriptableValueNode);","map":{"version":3,"names":["Node","addNodeClass","arrayBufferToBase64","base64ToArrayBuffer","addNodeElement","nodeProxy","float","EventDispatcher","ScriptableValueNode","_Node","_inherits","_super","_createSuper","_this","value","arguments","length","undefined","_classCallCheck","call","_value","_cache","inputType","outpuType","events","isScriptableValueNode","_createClass","key","get","outputType","set","val","ArrayBuffer","URL","revokeObjectURL","dispatchEvent","type","refresh","getValue","createObjectURL","Blob","isVector2","isVector3","isVector4","isColor","isMatrix3","isMatrix4","getNodeType","builder","isNode","setup","serialize","data","_get","_getPrototypeOf","prototype","toJSON","meta","uuid","deserialize","textures","nodes","scriptableValue"],"sources":["/home/darkadius/ros2_ws/src/BotshareWIP/ROS2/robotui/node_modules/three/examples/jsm/nodes/code/ScriptableValueNode.js"],"sourcesContent":["import Node, { addNodeClass } from '../core/Node.js';\nimport { arrayBufferToBase64, base64ToArrayBuffer } from '../core/NodeUtils.js';\nimport { addNodeElement, nodeProxy, float } from '../shadernode/ShaderNode.js';\nimport { EventDispatcher } from 'three';\n\nclass ScriptableValueNode extends Node {\n\n\tconstructor( value = null ) {\n\n\t\tsuper();\n\n\t\tthis._value = value;\n\t\tthis._cache = null;\n\n\t\tthis.inputType = null;\n\t\tthis.outpuType = null;\n\n\t\tthis.events = new EventDispatcher();\n\n\t\tthis.isScriptableValueNode = true;\n\n\t}\n\n\tget isScriptableOutputNode() {\n\n\t\treturn this.outputType !== null;\n\n\t}\n\n\tset value( val ) {\n\n\t\tif ( this._value === val ) return;\n\n\t\tif ( this._cache && this.inputType === 'URL' && this.value.value instanceof ArrayBuffer ) {\n\n\t\t\tURL.revokeObjectURL( this._cache );\n\n\t\t\tthis._cache = null;\n\n\t\t}\n\n\t\tthis._value = val;\n\n\t\tthis.events.dispatchEvent( { type: 'change' } );\n\n\t\tthis.refresh();\n\n\t}\n\n\tget value() {\n\n\t\treturn this._value;\n\n\t}\n\n\trefresh() {\n\n\t\tthis.events.dispatchEvent( { type: 'refresh' } );\n\n\t}\n\n\tgetValue() {\n\n\t\tconst value = this.value;\n\n\t\tif ( value && this._cache === null && this.inputType === 'URL' && value.value instanceof ArrayBuffer ) {\n\n\t\t\tthis._cache = URL.createObjectURL( new Blob( [ value.value ] ) );\n\n\t\t} else if ( value && value.value !== null && value.value !== undefined && (\n\t\t\t( ( this.inputType === 'URL' || this.inputType === 'String' ) && typeof value.value === 'string' ) ||\n\t\t\t( this.inputType === 'Number' && typeof value.value === 'number' ) ||\n\t\t\t( this.inputType === 'Vector2' && value.value.isVector2 ) ||\n\t\t\t( this.inputType === 'Vector3' && value.value.isVector3 ) ||\n\t\t\t( this.inputType === 'Vector4' && value.value.isVector4 ) ||\n\t\t\t( this.inputType === 'Color' && value.value.isColor ) ||\n\t\t\t( this.inputType === 'Matrix3' && value.value.isMatrix3 ) ||\n\t\t\t( this.inputType === 'Matrix4' && value.value.isMatrix4 )\n\t\t) ) {\n\n\t\t\treturn value.value;\n\n\t\t}\n\n\t\treturn this._cache || value;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.value && this.value.isNode ? this.value.getNodeType( builder ) : 'float';\n\n\t}\n\n\tsetup() {\n\n\t\treturn this.value && this.value.isNode ? this.value : float();\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tif ( this.value !== null ) {\n\n\t\t\tif ( this.inputType === 'ArrayBuffer' ) {\n\n\t\t\t\tdata.value = arrayBufferToBase64( this.value );\n\n\t\t\t} else {\n\n\t\t\t\tdata.value = this.value ? this.value.toJSON( data.meta ).uuid : null;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tdata.value = null;\n\n\t\t}\n\n\t\tdata.inputType = this.inputType;\n\t\tdata.outputType = this.outputType;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tlet value = null;\n\n\t\tif ( data.value !== null ) {\n\n\t\t\tif ( data.inputType === 'ArrayBuffer' ) {\n\n\t\t\t\tvalue = base64ToArrayBuffer( data.value );\n\n\t\t\t} else if ( data.inputType === 'Texture' ) {\n\n\t\t\t\tvalue = data.meta.textures[ data.value ];\n\n\t\t\t} else {\n\n\t\t\t\tvalue = data.meta.nodes[ data.value ] || null;\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.value = value;\n\n\t\tthis.inputType = data.inputType;\n\t\tthis.outputType = data.outputType;\n\n\t}\n\n}\n\nexport default ScriptableValueNode;\n\nexport const scriptableValue = nodeProxy( ScriptableValueNode );\n\naddNodeElement( 'scriptableValue', scriptableValue );\n\naddNodeClass( 'ScriptableValueNode', ScriptableValueNode );\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}